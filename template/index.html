{% extends './base.html' %}
{% load static %}
{% block content %}
<div class="row g-3 mb-3">
  <div class="col-xxl-6 col-xl-12">
    <div class="row g-3">
      <div class="col-12">
        <div class="card bg-transparent-50 overflow-hidden">
          <div class="card-header position-relative">
            <div class="bg-holder d-none d-md-block bg-card z-index-1" style="background-image:url(../assets/img/illustrations/ecommerce-bg.png);background-size:230px;background-position:right bottom;z-index:-1;">
            </div>
            <div class="position-relative z-index-2">
              <div>
                <h3 class="text-primary mb-1 label_time"></h3>
                <p class="text-dark">Esto es lo que sucede en la empresa el día de hoy</p>
              </div>
              <div class="d-flex py-3">
                <div class="ps-3">
                  <p class="text-600 fs--1 text-dark">Ventas totales de hoy</p>
                  <h4 class="text-800 mb-0">${{total_selling}} </h4>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body p-0">
            <ul class="mb-0 list-unstyled">
              <li class="alert mb-0 rounded-0 py-3 px-card alert-warning border-x-0 border-top-0">
                <div class="row flex-between-center">
                  <div class="col">
                    <div class="d-flex">
                      <div class="fas fa-circle mt-1 fs--2"></div>
                      <p class="fs--1 ps-2 mb-0"><strong>5 products</strong> didn’t publish to your Facebook page</p>
                    </div>
                  </div>
                  <div class="col-auto d-flex align-items-center"><a class="alert-link fs--1 fw-medium" href="#!">View products<i class="fas fa-chevron-right ms-1 fs--2"></i></a></div>
                </div>
              </li>
              <li class="alert mb-0 rounded-0 py-3 px-card greetings-item border-top border-x-0 border-top-0">
                <div class="row flex-between-center">
                  <div class="col">
                    <div class="d-flex">
                      <div class="fas fa-circle mt-1 fs--2 text-primary"></div>
                      <p class="fs--1 ps-2 mb-0"><strong>7 orders</strong> have payments that need to be captured</p>
                    </div>
                  </div>
                  <div class="col-auto d-flex align-items-center"><a class="alert-link fs--1 fw-medium" href="#!">View payments<i class="fas fa-chevron-right ms-1 fs--2"></i></a></div>
                </div>
              </li>
              <li class="alert mb-0 rounded-0 py-3 px-card greetings-item border-top  border-0">
                <div class="row flex-between-center">
                  <div class="col">
                    <div class="d-flex">
                      <div class="fas fa-circle mt-1 fs--2 text-primary"></div>
                      <p class="fs--1 ps-2 mb-0"><strong>50+ orders</strong> need to be fulfilled</p>
                    </div>
                  </div>
                  <div class="col-auto d-flex align-items-center"><a class="alert-link fs--1 fw-medium" href="#!">View orders<i class="fas fa-chevron-right ms-1 fs--2"></i></a></div>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-lg-12">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="card h-md-100 ecommerce-card-min-width">
              <div class="card-header pb-0">
                <h6 class="mb-0 mt-2 d-flex align-items-center">Ventas Semanales <span class="ms-1 text-400" data-bs-toggle="tooltip" data-bs-placement="top" title="Calculated according to last week's sales"><span class="far fa-question-circle" data-fa-transform="shrink-1"></span></span></h6>
              </div>
              <div class="card-body d-flex flex-column justify-content-end">
                <div class="row">
                  <div class="col">
                    <p class="font-sans-serif lh-1 mb-1 fs-2">$47K</p><span class="badge badge-soft-success rounded-pill fs--2">+3.5%</span>
                  </div>
                  <div class="col-auto ps-0">
                    <div class="echart-bar-weekly-sales h-100 echart-bar-weekly-sales-smaller-width"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card product-share-doughnut-width">
              <div class="card-header pb-0">
                <h6 class="mb-0 mt-2 d-flex align-items-center">Product Share</h6>
              </div>
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div class="d-flex flex-column justify-content-between">
                    <p class="font-sans-serif lh-1 mb-1 fs-2">34.6%</p><span class="badge badge-soft-warning rounded-pill fs--2"><span class="fas fa-caret-up me-1"></span>3.5%</span>
                  </div>
                  <div>
                    <canvas class="my-n5" id="marketShareDoughnut" width="112"></canvas>
                    <p class="mb-0 text-center fs--2 mt-4 text-500">Target: <span class="text-800">55% </span></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-xxl-6 col-xl-12">
    <div class="card py-3 mb-3">
      <div class="card-body py-3">
        <div class="row g-0">
          <div class="col-6 col-md-4 border-200 border-bottom border-end pb-4">
            <h6 class="pb-1 text-700">Factura POS </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">${{pos}} </p>
          </div>
          <div class="col-6 col-md-4 border-200 border-md-200 border-bottom border-md-end pb-4 ps-3">
            <h6 class="pb-1 text-700">Factura Elec.  </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">${{elec}} </p>
          </div>
          <div class="col-6 col-md-4 border-200 border-bottom border-end border-md-end-0 pb-4 pt-4 pt-md-0 ps-md-3">
            <h6 class="pb-1 text-700">Nota Crédito  </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">${{nc}} </p>
          </div>
          <div class="col-6 col-md-4 border-200 border-md-200 border-bottom border-md-bottom-0 border-md-end pt-4 pb-md-0 ps-3 ps-md-0">
            <h6 class="pb-1 text-700">Nota Débito </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">${{nd}} </p>
          </div>
          <div class="col-6 col-md-4 border-200 border-md-bottom-0 border-end pt-4 pb-md-0 ps-md-3">
            <h6 class="pb-1 text-700">Doc. Soporte </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">${{ds}} </p>
          </div>
          <div class="col-6 col-md-4 pb-0 pt-4 ps-3">
            <h6 class="pb-1 text-700">Traslados </h6>
            <p class="font-sans-serif lh-1 mb-1 fs-2">$0</p>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body pe-xxl-0">
        <div class="echart-line-total-sales-ecommerce" data-echart-responsive="true" data-options='{"optionOne":"ecommerceLastMonth"}'></div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col">
    <div class="card h-lg-100 overflow-hidden">
      <div class="card-body p-0">
        {% if data %}
          <div class="table-responsive scrollbar">
            <table class="table table-dashboard mb-0 table-borderless fs--1 border-200">
              <thead class="bg-light">
                <tr class="text-900">
                  <th class="text-dark">Productos más vendidos </th>
                  <th class="text-center text-dark">Cantidad Vendida</th>
                  <th class="text-center text-dark">Fecha</th>
                  <th class="text-end"></th>
                </tr>
              </thead>
              <tbody>
                {% for i in data %}
                  <tr class="border-bottom border-200">
                    <td>
                      <div class="d-flex align-items-center position-relative">
                        <div class="flex-1 ms-3">
                          <h6 class="mb-1 fw-semi-bold text-nowrap"><a class="text-900 stretched-link" href="javascript:void(0);">{{i.fields.product_name}}</a></h6>
                        </div>
                      </div>
                    </td>
                    <td class="align-middle text-center fw-semi-bold text-dark">{{i.fields.sold}}</td>
                    <td class="align-middle text-center fw-semi-bold text-dark">{{i.fields.date}}</td>
                    <td class="align-middle text-end fw-semi-bold"></td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <h2 class="p-2">No hay datos disponibles</h2>
        {% endif %}
      </div>
      <div class="card-footer bg-light py-2">
        <div class="row flex-between-center">
          <div class="col-auto">
            <p class="text-dark"></p>
          </div>
          <div class="col-auto">
            <a class="btn btn-sm btn-falcon-default" href="{% url 'List_Best_Selling_Product' %}">
              Ver Todos los registros
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block script %}
  <script>
    preferens_columm  = 0
    $(document).ready(function(){
      var horaActual = new Date().getHours();
      var limiteMañana = 12;
      var limiteTarde = 18;
      var mensaje;
      if (horaActual < limiteMañana) {
        mensaje = "¡Buen días, {{request.session.name_employee|title}}!.";
      } else if (horaActual < limiteTarde) {
        mensaje = "¡Buena tarde, {{request.session.name_employee|title}}!.";
      } else {
        mensaje = "¡Buena noche, {{request.session.name_employee|title}}!.";
      }
      $(".label_time").text(mensaje);
    })
  </script>
{% endblock %}